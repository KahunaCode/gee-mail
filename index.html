<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
        //console.log(geemails);
        
        var globalCounter = 1

        

        toAdd = document.createDocumentFragment();
        function getEmail(fragment){
        	for (var i = 0; i<geemails.length; i++){
				var emailDiv = document.createElement("div");
				emailDiv.className = "emailContainer"
				emailDiv.id = globalCounter+geemails[i].sender.replace(/ /g, '');
				emailDiv.addEventListener("click", displayBody)
				globalCounter++;

        		var date = document.createElement("div");
        		date.className = "dtg"
        		date.innerHTML = geemails[i].date
        		emailDiv.appendChild(date);

        		var subject = document.createElement("div");
        		subject.className = "subj"
        		subject.innerHTML = geemails[i].subject
        		emailDiv.appendChild(subject)

        		var sender = document.createElement("div");
        		sender.className = "sentBy"
        		sender.innerHTML = geemails[i].sender
        		emailDiv.appendChild(sender)

        		var body = document.createElement("div");
        		body.className = "body"
        		body.innerHTML = geemails[i].body
        		body.style.display = "none"
        		emailDiv.appendChild(body)

        		fragment.appendChild(emailDiv);
        } return fragment//console.log(emailDiv)
    }

    main.appendChild(getEmail(toAdd));
    
    //console.log(toAdd);
    var newAdd = document.createDocumentFragment();

    //function to append emails
    var appender = function(){
    	var newss = getEmail(newAdd);
    	main.appendChild(newss)
    }
    setInterval(appender, 5000);

    function displayBody(){
    	var emailContent = this.querySelectorAll(".body")[0];
  				if (emailContent.style.display === "none"){
    				emailContent.style.display = "block";
  				}else{
    			emailContent.style.display = "none";
    			}
    }

    function emailCounter(){
        	document.getElementById('mailCounter').innerHTML = `${document.getElementsByClassName('dtg').length} new emails`
    	}
    	setInterval(emailCounter, 5000);




      };
    </script>
	</head>
	<body>
		<div class="container" id="main">
			<header id="welcome">Welcome to Geemail!</header>
			<div id="mailCounter">10 new emails</div>
			<div id="emailContainer"></div>
		</div>
	</body>
</html>